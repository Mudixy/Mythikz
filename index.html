<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mythkiz - Collection de Cartes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 3em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            margin-bottom: 10px;
        }

        .nav {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .nav button {
            padding: 12px 24px;
            background: rgba(255,255,255,0.2);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .nav button:hover, .nav button.active {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .nav button.admin {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            border-color: #e74c3c;
        }

        .nav button.admin:hover {
            background: linear-gradient(45deg, #c0392b, #a93226);
        }

        .section {
            display: none;
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            backdrop-filter: blur(10px);
        }

        .section.active {
            display: block;
        }

        /* Login/Register Section */
        .auth-form {
            max-width: 400px;
            margin: 0 auto;
            text-align: center;
        }

        .auth-form h2 {
            margin-bottom: 20px;
            color: #667eea;
        }

        .form-group {
            margin-bottom: 20px;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .btn.danger {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
        }

        .btn.danger:hover {
            background: linear-gradient(45deg, #c0392b, #a93226);
        }

        .btn.success {
            background: linear-gradient(45deg, #27ae60, #229954);
        }

        .btn.success:hover {
            background: linear-gradient(45deg, #229954, #1e8449);
        }

        /* User Info */
        .user-info {
            text-align: center;
            margin-bottom: 20px;
            padding: 15px;
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            border-radius: 15px;
        }

        /* Admin Section */
        .admin-section {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            margin-bottom: 20px;
            padding: 15px;
            border-radius: 15px;
            text-align: center;
        }

        .users-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .user-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 2px solid #ddd;
        }

        .user-card h3 {
            color: #667eea;
            margin-bottom: 15px;
            text-align: center;
        }

        .user-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }

        .user-stat {
            text-align: center;
            padding: 10px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .user-stat .number {
            font-size: 1.5em;
            font-weight: bold;
            color: #667eea;
        }

        .user-stat .label {
            font-size: 0.8em;
            color: #666;
        }

        .user-actions {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
        }

        .user-actions .btn {
            margin: 5px;
            padding: 8px 16px;
            font-size: 14px;
        }

        /* Booster Opening Section */
        .booster-section {
            text-align: center;
            margin-bottom: 30px;
        }

        .booster-container {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 30px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .booster {
            width: 150px;
            height: 200px;
            background: linear-gradient(45deg, #ff6b6b, #feca57);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            position: relative;
            overflow: hidden;
        }

        .booster:hover:not(.disabled) {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 25px rgba(0,0,0,0.3);
        }

        .booster.disabled {
            opacity: 0.5;
            cursor: not-allowed;
            background: #999;
        }

        .booster.rare {
            background: linear-gradient(45deg, #3498db, #9b59b6);
        }

        .booster.epic {
            background: linear-gradient(45deg, #9b59b6, #e74c3c);
        }

        .booster.legendary {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            animation: legendary-glow 2s ease-in-out infinite alternate;
        }

        @keyframes legendary-glow {
            0% { box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
            100% { box-shadow: 0 5px 25px rgba(243, 156, 18, 0.5); }
        }

        .booster-icon {
            font-size: 3em;
            margin-bottom: 10px;
        }

        .booster-name {
            font-size: 1.1em;
            text-align: center;
        }

        .cooldown-info {
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .cooldown-timer {
            font-size: 1.2em;
            font-weight: bold;
            color: #e74c3c;
        }

        /* Cards Display */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }

        .card {
            background: white;
            border-radius: 10px;
            padding: 10px;
            text-align: center;
            box-shadow: 0 3px 10px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.3);
        }

        .card.common { border-color: #95a5a6; }
        .card.rare { border-color: #3498db; }
        .card.epic { border-color: #9b59b6; }
        .card.legendary { border-color: #f39c12; }

        .card-image {
  width: 100%;
  height: auto; /* au lieu de height: 150px */
  max-height: 300px; /* facultatif, pour √©viter que ce soit trop long */
  border-radius: 5px;
  margin-bottom: 10px;
  object-fit: contain;
  background: #f0f0f0;
  display: block;
}


        .card-name {
            font-weight: bold;
            margin-bottom: 5px;
            font-size: 0.9em;
        }

        .card-rarity {
            font-size: 0.8em;
            text-transform: uppercase;
            font-weight: bold;
        }

        .card-rarity.common { color: #95a5a6; }
        .card-rarity.rare { color: #3498db; }
        .card-rarity.epic { color: #9b59b6; }
        .card-rarity.legendary { color: #f39c12; }

        /* Modal for opened cards */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            max-width: 90%;
            max-height: 90%;
            overflow-y: auto;
        }

        .modal h2 {
            color: #667eea;
            margin-bottom: 20px;
        }

        .close {
            position: absolute;
            top: 10px;
            right: 20px;
            font-size: 30px;
            cursor: pointer;
            color: #999;
        }

        .close:hover {
            color: #333;
        }

        /* Stats */
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 20px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .hidden {
            display: none !important;
        }

        @keyframes cardReveal {
            0% { transform: rotateY(180deg) scale(0.8); opacity: 0; }
            50% { transform: rotateY(90deg) scale(1.1); }
            100% { transform: rotateY(0deg) scale(1); opacity: 1; }
        }

        .card-reveal {
            animation: cardReveal 0.8s ease-out;
        }

        .booster-count {
            background: rgba(255,255,255,0.2);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
        }

        .admin-controls {
            background: rgba(255,255,255,0.1);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
        }

        .admin-controls h3 {
            color: white;
            margin-bottom: 15px;
            text-align: center;
        }

        .global-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .modal .card-image {
            height: 120px; /* Plus petit dans le modal */
            object-fit: contain;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé¥ Mythkiz V0.1</h1>
            <p>Collectionnez, √©changez, dominez !</p>
        </div>

        <!-- Navigation -->
        <div class="nav">
            <button onclick="showSection('login')" class="nav-btn active" id="login-nav">Connexion</button>
            <button onclick="showSection('boosters')" class="nav-btn hidden" id="boosters-nav">Boosters</button>
            <button onclick="showSection('collection')" class="nav-btn hidden" id="collection-nav">Collection</button>
            <button onclick="showSection('admin')" class="nav-btn admin hidden" id="admin-nav">üîß Admin</button>
            <button onclick="logout()" class="nav-btn hidden" id="logout-nav">D√©connexion</button>
        </div>

        <!-- Login Section -->
        <div id="login" class="section active">
            <div class="auth-form">
                <h2>Connexion / Inscription</h2>
                <div class="form-group">
                    <label for="username">Nom d'utilisateur:</label>
                    <input type="text" id="username" placeholder="Entrez votre nom d'utilisateur">
                </div>
                <div class="form-group">
                    <label for="password">Mot de passe:</label>
                    <input type="password" id="password" placeholder="Entrez votre mot de passe">
                </div>
                <button class="btn" onclick="login()">Se connecter</button>
                <button class="btn" onclick="register()">S'inscrire</button>
                <p style="margin-top: 20px; color: #666;">
                    Nouveau joueur ? Cr√©ez un compte pour commencer votre collection !
                </p>
            </div>
        </div>

        <!-- Admin Section -->
        <div id="admin" class="section">
            <div class="admin-section">
                <h2>üîß Dashboard Administrateur</h2>
                <p>Bienvenue MaximeBertin ! G√©rez tous les utilisateurs depuis ce panneau.</p>
            </div>

            <div class="admin-controls">
                <h3>Actions Globales</h3>
                <div class="global-actions">
                    <button class="btn danger" onclick="resetAllCollections()">üóëÔ∏è R√©initialiser toutes les collections</button>
                    <button class="btn success" onclick="giveBoostersToAll()">üéÅ Donner 2 boosters √† tous</button>
                    <button class="btn" onclick="exportUserData()">üìä Exporter les donn√©es</button>
                </div>
            </div>

            <h3 style="text-align: center; margin-bottom: 20px;">Gestion des Utilisateurs</h3>
            <div id="users-list" class="users-grid">
                <!-- Users will be populated here -->
            </div>
        </div>

        <!-- Boosters Section -->
        <div id="boosters" class="section">
            <div class="user-info">
                <h3>Bienvenue, <span id="current-user"></span>!</h3>
                <div class="booster-count">
                    <p>üì¶ Boosters disponibles: <span id="available-boosters">2</span>/2</p>
                </div>
            </div>

            <div class="booster-section">
                <h2>üéÅ Ouvrir un Booster</h2>
                <p>Vous pouvez ouvrir 2 boosters toutes les 3 heures</p>
                
                <div id="cooldown-info" class="cooldown-info hidden">
                    <p>‚è∞ Prochain booster disponible dans:</p>
                    <div id="cooldown-timer" class="cooldown-timer">--:--:--</div>
                </div>

                <div class="booster-container">
                    <div class="booster" id="booster-btn" onclick="openRandomBooster()">
                        <div class="booster-icon">üì¶</div>
                        <div class="booster-name">Booster Myst√®re</div>
                    </div>
                </div>

                <p style="color: #666; margin-top: 20px;">
                    Chaque booster contient 5 cartes al√©atoires !<br>
                    Plus le booster est rare, meilleures sont les cartes !
                </p>
            </div>

            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="total-cards">0</div>
                    <div>Cartes Total</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="boosters-opened">0</div>
                    <div>Boosters Ouverts</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="legendary-count">0</div>
                    <div>Cartes L√©gendaires</div>
                </div>
            </div>
        </div>

        <!-- Collection Section -->
        <div id="collection" class="section">
            <h2>üìö Ma Collection</h2>
            <div class="nav" style="margin-bottom: 20px;">
                <button class="btn" onclick="filterCards('all')">Toutes</button>
                <button class="btn" onclick="filterCards('common')">Communes</button>
                <button class="btn" onclick="filterCards('uncommon')">Peu communes</button>
                <button class="btn" onclick="filterCards('rare')">Rares</button>
                <button class="btn" onclick="filterCards('epic')">√âpiques</button>
                <button class="btn" onclick="filterCards('legendary')">L√©gendaires</button>
                <button class="btn" onclick="filterCards('divine')">Divines</button>
            </div>
            <div id="collection-grid" class="cards-grid">
                <p style="text-align: center; color: #666; grid-column: 1/-1;">
                    Votre collection est vide. Ouvrez des boosters pour commencer !
                </p>
            </div>
        </div>
    </div>

    <!-- Modal for opened cards -->
    <div id="card-modal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <h2 id="modal-title">üéâ Nouvelles Cartes Obtenues !</h2>
            <div id="opened-cards" class="cards-grid"></div>
            <button class="btn" onclick="closeModal()">Fermer</button>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirm-modal" class="modal">
        <div class="modal-content">
            <h2>‚ö†Ô∏è Confirmation</h2>
            <p id="confirm-message">√ätes-vous s√ªr de vouloir effectuer cette action ?</p>
            <div style="margin-top: 20px;">
                <button class="btn danger" id="confirm-yes">Oui</button>
                <button class="btn" onclick="closeConfirmModal()">Annuler</button>
            </div>
        </div>
    </div>

    <script>
        // REMPLACEZ CES DONN√âES PAR VOS PROPRES CARTES
        const cardDatabase = [
            // Exemple avec vos liens d'images - REMPLACEZ PAR VOS VRAIES DONN√âES
            // Common cards
            { id: 2, name: "Mcfly & Carlito", rarity: "common", image: "https://i.ibb.co/k2v2KKRG/S1-002.png" },
            { id: 3, name: "Inoxtag", rarity: "common", image: "https://i.ibb.co/S7mnZkQx/S1-003.png" },
            { id: 8, name: "Mastu", rarity: "common", image: "https://i.ibb.co/qFjwdPYR/S1-008.png" },
            { id: 13, name: "Amine", rarity: "common", image: "https://i.ibb.co/p5gyZZr/S1-013.png" },
            { id: 14, name: "Doigby", rarity: "common", image: "https://i.ibb.co/Mky77bGx/S1-014.png" },
            { id: 16, name: "Wankil Studio", rarity: "common", image: "https://i.ibb.co/hFvVdKMT/S1-016.png" },
            { id: 18, name: "Michou", rarity: "common", image: "https://i.ibb.co/X6MHSxp/S1-018.png" },
            { id: 20, name: "Kameto", rarity: "common", image: "https://i.ibb.co/mV7Scg4f/S1-020.png" },
            { id: 21, name: "√âtoiles", rarity: "common", image: "https://i.ibb.co/mCXsJWqJ/S1-021.png" },
            { id: 27, name: "Olivier Minne", rarity: "common", image: "https://i.ibb.co/VWPPLzNY/S1-027.png" },
            { id: 28, name: "Djilsi", rarity: "common", image: "https://i.ibb.co/F4F9cwJ2/S1-028.png" },
            { id: 29, name: "Merde", rarity: "common", image: "https://i.ibb.co/TMbfSNVg/S1-029.png" },
            { id: 36, name: "Bilal Hassani", rarity: "common", image: "https://i.ibb.co/s9Sn8CMR/S1-036.png" },
            { id: 49, name: "Jean-Paul Rouve", rarity: "common", image: "https://i.ibb.co/27PdNKYJ/S1-049.png" },

            // Uncommun cards
            { id: 5, name: "Amixem", rarity: "uncommun", image: "https://i.ibb.co/b59R4q29/S1-005.png" },
            { id: 10, name: "CyrilMP4", rarity: "uncommun", image: "https://i.ibb.co/RkpkZCJ7/S1-010.png" },
            { id: 11, name: "FuzeIII", rarity: "uncommun", image: "https://i.ibb.co/mCCngBsp/S1-011.png" },
            { id: 15, name: "ZeratoR", rarity: "uncommun", image: "https://i.ibb.co/QWgfn5b/S1-015.png" },
            { id: 19, name: "Byilhan", rarity: "uncommun", image: "https://i.ibb.co/20VTm9ZR/S1-019.png" },
            { id: 24, name: "Rewind de Twitch", rarity: "uncommun", image: "https://i.ibb.co/SDCsYt2R/S1-024.png" },
            { id: 37, name: "Napol√©on Bonaparte", rarity: "uncommun", image: "https://i.ibb.co/F4FLW18z/S1-037.png" },
            { id: 45, name: "Julien Dor√©", rarity: "uncommun", image: "https://i.ibb.co/zTBZMQ8F/S1-045.png" },
            { id: 46, name: "Jean Dujardin", rarity: "uncommun", image: "https://i.ibb.co/Mkb3SBZp/S1-046.png" },

            // Rare cards
            { id: 1, name: "Squeezie", rarity: "rare", image: "https://i.ibb.co/b5JNS8CY/S1-001.png" },
            { id: 22, name: "√âtoiles", rarity: "rare", image: "https://i.ibb.co/XPCd4LD/S1-022.png" },
            { id: 23, name: "Domingo", rarity: "rare", image: "https://i.ibb.co/93WTZgyP/S1-023.png" },
            { id: 30, name: "Natoo", rarity: "rare", image: "https://i.ibb.co/M4CbgV7/S1-030.png" },
            { id: 31, name: "McFly", rarity: "rare", image: "https://i.ibb.co/SXSctKRC/S1-031.png" },
            { id: 32, name: "Carlito", rarity: "rare", image: "https://i.ibb.co/hxLjPKQN/S1-032.png" },
            { id: 33, name: "Thomas Pesquet", rarity: "rare", image: "https://i.ibb.co/ch2dF7fZ/S1-033.png" },
            { id: 39, name: "Cyril F√©raud", rarity: "rare", image: "https://i.ibb.co/7N4cf6gF/S1-039.png" },
            { id: 40, name: "JuL", rarity: "rare", image: "https://i.ibb.co/N6W9jTXP/S1-040.png" },
            { id: 50, name: "Jeff Tuche", rarity: "rare", image: "https://i.ibb.co/bRWQndSv/S1-050.png" },

            // Epic cards
            { id: 7, name: "Joyca", rarity: "epic", image: "https://i.ibb.co/35J1cg7F/S1-007.png" },
            { id: 12, name: "Squeezie", rarity: "epic", image: "https://i.ibb.co/XxVn5ht4/S1-012.png" },
            { id: 34, name: "Neil Armstrong", rarity: "epic", image: "https://i.ibb.co/KjQXDXY5/S1-034.png" },
            { id: 35, name: "Danielou", rarity: "epic", image: "https://i.ibb.co/qLqT5nZv/S1-035.png" },
            { id: 41, name: "Jean-Luc Reichmann", rarity: "epic", image: "https://i.ibb.co/TMfLQWZn/S1-041.png" },
            { id: 42, name: "√âmilien", rarity: "epic", image: "https://i.ibb.co/YTQdkh3x/S1-042.png" },
            
            // Legendary cards
            { id: 4, name: "Inoxtag", rarity: "legendary", image: "https://i.ibb.co/VYxgyJsN/S1-004.png" },
            { id: 17, name: "Thomas Deseur", rarity: "legendary", image: "https://i.ibb.co/Y7ByWTXm/S1-017.png" },
            { id: 25, name: "Xavier Dupont de Ligonn√®s & Marine Le Pen en Alg√©rie", rarity: "legendary", image: "https://i.ibb.co/8npMnzc7/S1-025.png" },
            { id: 38, name: "Karine Le Marchand", rarity: "legendary", image: "https://i.ibb.co/m50Jx8Xw/S1-038.png" },
            { id: 43, name: "Gilles Bouleau", rarity: "legendary", image: "https://i.ibb.co/TMLxFSjw/S1-043.png" },
            { id: 44, name: "Squeezie", rarity: "legendary", image: "https://i.ibb.co/DfZBXQv0/S1-044.png" },
            { id: 47, name: "Brice de Nice", rarity: "legendary", image: "https://i.ibb.co/nNT6M0v5/S1-047.png" },
            { id: 48, name: "Hubert Bonisseur de la Bath", rarity: "legendary", image: "https://i.ibb.co/nqRyksfH/S1-048.png" },

            // Divine
            { id: 9, name: "Anyme", rarity: "divine", image: "https://i.ibb.co/r2WnG11P/S1-009.png" },
            { id: 26, name: "Montcuq", rarity: "divine", image: "https://i.ibb.co/rRpTq5Zp/S1-026.png" },
        ];

        // Game state
        let currentUser = null;
        let gameData = {};

        // Booster types with probabilities
        const boosterTypes = [
            { 
                name: "Booster Commun", 
                rarity: "common", 
                probability: 0.8,
                cardProbabilities: { common: 0.5, uncommon: 0.3, rare: 0.15, epic: 0.04, legendary: 0.01 },
                icon: "üì¶",
                gradient: "linear-gradient(45deg, #95a5a6, #7f8c8d)"
            },
            { 
                name: "Booster Rare", 
                rarity: "rare", 
                probability: 0.1,
                cardProbabilities: { common: 0.4, uncommon: 0.2, rare: 0.25, epic: 0.12, legendary: 0.03 },
                icon: "‚ú®",
                gradient: "linear-gradient(45deg, #3498db, #2980b9)"
            },
            { 
                name: "Booster √âpique", 
                rarity: "epic", 
                probability: 0.07,
                cardProbabilities: { common: 0.3, uncommon: 0.3, rare: 0.1, epic: 0.25, legendary: 0.05 },
                icon: "üíé",
                gradient: "linear-gradient(45deg, #9b59b6, #8e44ad)"
            },
            { 
                name: "Booster L√©gendaire", 
                rarity: "legendary", 
                probability: 0.03,
                cardProbabilities: { common: 0.2, uncommon: 0.2, rare: 0.2, epic: 0.25, legendary: 0.12, divine: 0.03 },
                icon: "üëë",
                gradient: "linear-gradient(45deg, #f39c12, #e67e22)"
            }
        ];

        // Initialize game
        function initGame() {
            loadGameData();
            updateStats();
            updateCooldownDisplay();
            setInterval(updateCooldownDisplay, 1000); // Update every second
        }

        // User management
        function login() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            if (!username || !password) {
                alert('Veuillez remplir tous les champs !');
                return;
            }

            const users = JSON.parse(localStorage.getItem('Mythkiz_users') || '{}');
            
            if (users[username] && users[username].password === password) {
                currentUser = username;
                gameData = users[username];
                
                // Initialize new fields for existing users
                if (!gameData.hasOwnProperty('availableBoosters')) {
                    gameData.availableBoosters = 2;
                    gameData.lastBoosterTime = 0;
                }
                
                showGameInterface();
                updateUserInfo();
                updateStats();
                displayCollection();
                updateCooldownDisplay();

                // Show admin panel if user is MaximeBertin
                if (username === 'MaximeBertin') {
                    document.getElementById('admin-nav').classList.remove('hidden');
                    loadAdminPanel();
                }
            } else {
                alert('Nom d\'utilisateur ou mot de passe incorrect !');
            }
        }

        function register() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            
            if (!username || !password) {
                alert('Veuillez remplir tous les champs !');
                return;
            }

            const users = JSON.parse(localStorage.getItem('Mythkiz_users') || '{}');
            
            if (users[username]) {
                alert('Ce nom d\'utilisateur existe d√©j√† !');
                return;
            }

            // Create new user
            users[username] = {
                password: password,
                cards: [],
                boostersOpened: 0,
                availableBoosters: 2,
                lastBoosterTime: 0
            };

            localStorage.setItem('Mythkiz_users', JSON.stringify(users));
            
            currentUser = username;
            gameData = users[username];
            showGameInterface();
            updateUserInfo();
            updateStats();

            // Show admin panel if user is MaximeBertin
            if (username === 'MaximeBertin') {
                document.getElementById('admin-nav').classList.remove('hidden');
                loadAdminPanel();
            }
            
            alert('Compte cr√©√© avec succ√®s ! Bienvenue dans Mythkiz !');
        }

        function logout() {
            currentUser = null;
            gameData = {};
            showSection('login');
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
            
            // Hide game navigation
            document.getElementById('boosters-nav').classList.add('hidden');
            document.getElementById('collection-nav').classList.add('hidden');
            document.getElementById('admin-nav').classList.add('hidden');
            document.getElementById('logout-nav').classList.add('hidden');
            document.getElementById('login-nav').classList.remove('hidden');
        }

        function showGameInterface() {
            document.getElementById('login-nav').classList.add('hidden');
            document.getElementById('boosters-nav').classList.remove('hidden');
            document.getElementById('collection-nav').classList.remove('hidden');
            document.getElementById('logout-nav').classList.remove('hidden');
            showSection('boosters');
        }

        function updateUserInfo() {
            document.getElementById('current-user').textContent = currentUser;
            document.getElementById('available-boosters').textContent = gameData.availableBoosters;
        }

        // Navigation
        function showSection(sectionName) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionName).classList.add('active');
            
            // Update navigation buttons
            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            if (sectionName !== 'login') {
                document.getElementById(sectionName + '-nav').classList.add('active');
            }

            // Load admin panel if accessing admin section
            if (sectionName === 'admin') {
                loadAdminPanel();
            }
        }

        // Admin Functions
        function loadAdminPanel() {
            if (currentUser !== 'MaximeBertin') return;

            const users = JSON.parse(localStorage.getItem('Mythkiz_users') || '{}');
            const usersList = document.getElementById('users-list');
            usersList.innerHTML = '';

            Object.keys(users).forEach(username => {
                if (username === 'MaximeBertin') return; // Don't show admin in list

                const userData = users[username];
                const userCard = createUserCard(username, userData);
                usersList.appendChild(userCard);
            });

            if (Object.keys(users).length <= 1) {
                usersList.innerHTML = '<p style="text-align: center; color: #666; grid-column: 1/-1;">Aucun utilisateur √† g√©rer.</p>';
            }
        }

        function createUserCard(username, userData) {
            const cardDiv = document.createElement('div');
            cardDiv.className = 'user-card';

            const totalCards = userData.cards ? userData.cards.length : 0;
            const legendaryCards = userData.cards ? userData.cards.filter(card => card.rarity === 'legendary').length : 0;
            const boostersOpened = userData.boostersOpened || 0;
            const availableBoosters = userData.availableBoosters || 0;

            cardDiv.innerHTML = `
                <h3>üë§ ${username}</h3>
                <div class="user-stats">
                    <div class="user-stat">
                        <div class="number">${totalCards}</div>
                        <div class="label">Cartes</div>
                    </div>
                    <div class="user-stat">
                        <div class="number">${legendaryCards}</div>
                        <div class="label">L√©gendaires</div>
                    </div>
                    <div class="user-stat">
                        <div class="number">${boostersOpened}</div>
                        <div class="label">Boosters Ouverts</div>
                    </div>
                    <div class="user-stat">
                        <div class="number">${availableBoosters}</div>
                        <div class="label">Boosters Dispo</div>
                    </div>
                </div>
                <div class="user-actions">
                    <button class="btn success" onclick="giveBoosters('${username}', 1)">+1 Booster</button>
                    <button class="btn success" onclick="giveBoosters('${username}', 2)">+2 Boosters</button>
                    <button class="btn" onclick="resetCooldown('${username}')">Reset Cooldown</button>
                    <button class="btn danger" onclick="resetUserCollection('${username}')">Reset Collection</button>
                </div>
            `;

            return cardDiv;
        }

        function giveBoosters(username, amount) {
            const users = JSON.parse(localStorage.getItem('Mythkiz_users') || '{}');
            if (users[username]) {
                users[username].availableBoosters = Math.min(2, (users[username].availableBoosters || 0) + amount);
                localStorage.setItem('Mythkiz_users', JSON.stringify(users));
                loadAdminPanel();
                alert(`${amount} booster(s) donn√©(s) √† ${username} !`);
            }
        }

        function resetCooldown(username) {
            const users = JSON.parse(localStorage.getItem('Mythkiz_users') || '{}');
            if (users[username]) {
                users[username].lastBoosterTime = 0;
                users[username].availableBoosters = 2;
                localStorage.setItem('Mythkiz_users', JSON.stringify(users));
                loadAdminPanel();
                alert(`Cooldown r√©initialis√© pour ${username} !`);
            }
        }

        function resetUserCollection(username) {
            showConfirmModal(
                `√ätes-vous s√ªr de vouloir r√©initialiser la collection de ${username} ? Cette action est irr√©versible !`,
                () => {
                    const users = JSON.parse(localStorage.getItem('Mythkiz_users') || '{}');
                    if (users[username]) {
                        users[username].cards = [];
                        users[username].boostersOpened = 0;
                        localStorage.setItem('Mythkiz_users', JSON.stringify(users));
                        loadAdminPanel();
                        alert(`Collection de ${username} r√©initialis√©e !`);
                    }
                }
            );
        }

        function resetAllCollections() {
            showConfirmModal(
                '√ätes-vous s√ªr de vouloir r√©initialiser TOUTES les collections ? Cette action est irr√©versible !',
                () => {
                    const users = JSON.parse(localStorage.getItem('Mythkiz_users') || '{}');
                    Object.keys(users).forEach(username => {
                        if (username !== 'MaximeBertin') {
                            users[username].cards = [];
                            users[username].boostersOpened = 0;
                        }
                    });
                    localStorage.setItem('Mythkiz_users', JSON.stringify(users));
                    loadAdminPanel();
                    alert('Toutes les collections ont √©t√© r√©initialis√©es !');
                }
            );
        }

        function giveBoostersToAll() {
            const users = JSON.parse(localStorage.getItem('Mythkiz_users') || '{}');
            let count = 0;
            Object.keys(users).forEach(username => {
                if (username !== 'MaximeBertin') {
                    users[username].availableBoosters = 2;
                    users[username].lastBoosterTime = 0;
                    count++;
                }
            });
            localStorage.setItem('Mythkiz_users', JSON.stringify(users));
            loadAdminPanel();
            alert(`2 boosters donn√©s √† ${count} utilisateur(s) !`);
        }

        function exportUserData() {
            const users = JSON.parse(localStorage.getItem('Mythkiz_users') || '{}');
            const exportData = {};
            
            Object.keys(users).forEach(username => {
                if (username !== 'MaximeBertin') {
                    const userData = users[username];
                    exportData[username] = {
                        totalCards: userData.cards ? userData.cards.length : 0,
                        legendaryCards: userData.cards ? userData.cards.filter(card => card.rarity === 'legendary').length : 0,
                        boostersOpened: userData.boostersOpened || 0,
                        availableBoosters: userData.availableBoosters || 0
                    };
                }
            });

            const dataStr = JSON.stringify(exportData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'Mythkiz_users_data.json';
            link.click();
        }

        // Confirmation Modal
        function showConfirmModal(message, onConfirm) {
            document.getElementById('confirm-message').textContent = message;
            document.getElementById('confirm-yes').onclick = () => {
                onConfirm();
                closeConfirmModal();
            };
            document.getElementById('confirm-modal').style.display = 'block';
        }

        function closeConfirmModal() {
            document.getElementById('confirm-modal').style.display = 'none';
        }

        // Cooldown system
        function updateCooldownDisplay() {
            if (!gameData) return;

            const now = Date.now();
            const timeSinceLastBooster = now - gameData.lastBoosterTime;
            const cooldownTime = 3 * 60 * 60 * 1000; // 3 hours in milliseconds

            // Check if we should give new boosters
            if (timeSinceLastBooster >= cooldownTime && gameData.availableBoosters < 2) {
                const boostersToAdd = Math.min(2, Math.floor(timeSinceLastBooster / cooldownTime));
                gameData.availableBoosters = Math.min(2, gameData.availableBoosters + boostersToAdd);
                gameData.lastBoosterTime = now;
                saveGameData();
                updateUserInfo();
            }

            const boosterBtn = document.getElementById('booster-btn');
            const cooldownInfo = document.getElementById('cooldown-info');
            const cooldownTimer = document.getElementById('cooldown-timer');

            if (gameData.availableBoosters > 0) {
                boosterBtn.classList.remove('disabled');
                cooldownInfo.classList.add('hidden');
            } else {
                boosterBtn.classList.add('disabled');
                cooldownInfo.classList.remove('hidden');
                
                const timeUntilNext = cooldownTime - timeSinceLastBooster;
                const hours = Math.floor(timeUntilNext / (1000 * 60 * 60));
                const minutes = Math.floor((timeUntilNext % (1000 * 60 * 60)) / (1000 * 60));
                const seconds = Math.floor((timeUntilNext % (1000 * 60)) / 1000);
                
                cooldownTimer.textContent = `${hours.toString().padStart(2, '0')}:${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            }
        }

        // Booster opening
        function openRandomBooster() {
            if (gameData.availableBoosters <= 0) {
                alert('Aucun booster disponible ! Attendez le cooldown.');
                return;
            }

            // Determine booster type based on probability
            const random = Math.random();
            let cumulativeProbability = 0;
            let selectedBooster = boosterTypes[0]; // fallback

            for (const booster of boosterTypes) {
                cumulativeProbability += booster.probability;
                if (random <= cumulativeProbability) {
                    selectedBooster = booster;
                    break;
                }
            }

            // Update booster appearance
            const boosterBtn = document.getElementById('booster-btn');
            const modalTitle = document.getElementById('modal-title');
            
            boosterBtn.style.background = selectedBooster.gradient;
            boosterBtn.innerHTML = `
                <div class="booster-icon">${selectedBooster.icon}</div>
                <div class="booster-name">${selectedBooster.name}</div>
            `;

            if (selectedBooster.rarity === 'legendary') {
                boosterBtn.classList.add('legendary');
            }

            modalTitle.textContent = `üéâ ${selectedBooster.name} Ouvert !`;

            // Consume booster
            gameData.availableBoosters--;
            gameData.boostersOpened++;
            gameData.lastBoosterTime = Date.now();

            // Generate 5 cards based on booster probabilities
            let newCards = [];
            for (let i = 0; i < 5; i++) {
                const card = getRandomCard(selectedBooster.cardProbabilities);
                newCards.push(card);
                gameData.cards.push(card);
            }

            saveGameData();
            updateUserInfo();
            updateStats();
            updateCooldownDisplay();
            showOpenedCards(newCards);

            // Reset booster appearance after a delay
            setTimeout(() => {
                boosterBtn.style.background = '';
                boosterBtn.classList.remove('legendary');
                boosterBtn.innerHTML = `
                    <div class="booster-icon">üì¶</div>
                    <div class="booster-name">Booster Myst√®re</div>
                `;
            }, 3000);
        }

        function getRandomCard(probabilities) {
            const random = Math.random();
            let cumulativeProbability = 0;
            
            const rarities = ['common', 'rare', 'epic', 'legendary'];
            
            for (const rarity of rarities) {
                cumulativeProbability += probabilities[rarity];
                if (random <= cumulativeProbability) {
                    const cardsOfRarity = cardDatabase.filter(card => card.rarity === rarity);
                    if (cardsOfRarity.length > 0) {
                        return cardsOfRarity[Math.floor(Math.random() * cardsOfRarity.length)];
                    }
                }
            }
            
            // Fallback to first card
            return cardDatabase[0];
        }

        function showOpenedCards(cards) {
            const modal = document.getElementById('card-modal');
            const container = document.getElementById('opened-cards');
            
            container.innerHTML = '';
            
            cards.forEach((card, index) => {
                setTimeout(() => {
                    const cardElement = createCardElement(card);
                    cardElement.classList.add('card-reveal');
                    container.appendChild(cardElement);
                }, index * 200);
            });
            
            modal.style.display = 'block';
        }

        function closeModal() {
            document.getElementById('card-modal').style.display = 'none';
            displayCollection();
        }

        // Collection management
        function displayCollection(filter = 'all') {
            const container = document.getElementById('collection-grid');
            container.innerHTML = '';

            if (!gameData.cards || gameData.cards.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #666; grid-column: 1/-1;">Votre collection est vide. Ouvrez des boosters pour commencer !</p>';
                return;
            }

            // Count cards by ID
            const cardCounts = {};
            gameData.cards.forEach(card => {
                cardCounts[card.id] = (cardCounts[card.id] || 0) + 1;
            });

            // Get unique cards
            const uniqueCards = [];
            const seenIds = new Set();
            
            gameData.cards.forEach(card => {
                if (!seenIds.has(card.id)) {
                    seenIds.add(card.id);
                    uniqueCards.push({...card, count: cardCounts[card.id]});
                }
            });

            // Filter cards
            const filteredCards = filter === 'all' 
                ? uniqueCards 
                : uniqueCards.filter(card => card.rarity === filter);

            // Sort by rarity and name
            const rarityOrder = { 'legendary': 4, 'epic': 3, 'rare': 2, 'common': 1 };
            filteredCards.sort((a, b) => {
                if (rarityOrder[a.rarity] !== rarityOrder[b.rarity]) {
                    return rarityOrder[b.rarity] - rarityOrder[a.rarity];
                }
                return a.name.localeCompare(b.name);
            });

            filteredCards.forEach(card => {
                const cardElement = createCardElement(card, true);
                container.appendChild(cardElement);
            });
        }

        function createCardElement(card, showCount = false) {
            const cardDiv = document.createElement('div');
            cardDiv.className = `card ${card.rarity}`;
            
            cardDiv.innerHTML = `
                <img src="${card.image}" alt="${card.name}" class="card-image" onerror="this.src='https://via.placeholder.com/300x450?text=Image+manquante';">
                <div class="card-name">${card.name}</div>
                <div class="card-rarity ${card.rarity}">${card.rarity}</div>
                ${showCount && card.count > 1 ? `<div style="font-weight: bold; color: #667eea;">x${card.count}</div>` : ''}
            `;
            
            return cardDiv;
        }

        function filterCards(rarity) {
            displayCollection(rarity);
        }

        // Statistics
        function updateStats() {
            if (!gameData.cards) return;
            
            document.getElementById('total-cards').textContent = gameData.cards.length;
            document.getElementById('boosters-opened').textContent = gameData.boostersOpened || 0;
            
            const legendaryCount = gameData.cards.filter(card => card.rarity === 'legendary').length;
            document.getElementById('legendary-count').textContent = legendaryCount;
        }

        // Data persistence
        function saveGameData() {
            const users = JSON.parse(localStorage.getItem('Mythkiz_users') || '{}');
            users[currentUser] = gameData;
            localStorage.setItem('Mythkiz_users', JSON.stringify(users));
        }

        function loadGameData() {
            const users = JSON.parse(localStorage.getItem('Mythkiz_users') || '{}');
            if (currentUser && users[currentUser]) {
                gameData = users[currentUser];
            }
        }

        // Initialize game on page load
        window.addEventListener('load', initGame);

        // Close modal when clicking outside
        window.addEventListener('click', function(event) {
            const modal = document.getElementById('card-modal');
            const confirmModal = document.getElementById('confirm-modal');
            if (event.target === modal) {
                closeModal();
            }
            if (event.target === confirmModal) {
                closeConfirmModal();
            }
        });
    </script>
</body>
</html>